REM WIX Build
cd "%src%\%wixBuildDirProjectName%"
:: Use candle and light commands will ignore the .wixproj file, but we should keep that file for local build
"%WIX%\bin\candle" -dProductVersion=%VersionNumber% -d"DevEnvDir=%DevEnvDir%\" -dSolutionDir=%src%\ -dSolutionExt=.sln -d"SolutionFileName=%solutionName%.sln" -d"SolutionName=%solutionName%" -d"SolutionPath=%src%\%solutionName%.sln" -dConfiguration=%buildConfiguration% -dOutDir=bin\%buildConfiguration%\ -dPlatform=x86 -d"ProjectDir=%src%\%wixBuildDirProjectName%\\" -dProjectExt=.wixproj -dProjectFileName=%wixBuildDirProjectName%.wixproj -dProjectName=%wixBuildDirProjectName% -d"ProjectPath=%src%\%wixBuildDirProjectName%\%wixBuildDirProjectName%.wixproj" -d"TargetDir=%src%\%wixBuildDirProjectName%\bin\%buildConfiguration%\\" -dTargetExt=.msi -dTargetFileName=%wixBuildDirProjectName%.msi -dTargetName=%wixBuildDirProjectName% -d"TargetPath=%src%\%wixBuildDirProjectName%\bin\%buildConfiguration%\%wixBuildDirProjectName%.msi" -d"%solutionName%.DataAccess.Configuration=%buildConfiguration%" -d"%solutionName%.DataAccess.FullConfiguration=%buildConfiguration%|%wixBuildPlatform%" -d"%solutionName%.DataAccess.Platform=%wixBuildPlatform%" -d"%solutionName%.DataAccess.ProjectDir=%src%\%solutionName%.DataAccess\\" -d"%solutionName%.DataAccess.ProjectExt=.csproj" -d"%solutionName%.DataAccess.ProjectFileName=%solutionName%.DataAccess.csproj" -d"%solutionName%.DataAccess.ProjectName=%solutionName%.DataAccess" -d"%solutionName%.DataAccess.ProjectPath=%src%\%solutionName%.DataAccess\%solutionName%.DataAccess.csproj" -d"%solutionName%.DataAccess.TargetDir=%src%\%solutionName%.DataAccess\bin\%buildConfiguration%\%wixBuildNet6Dir%\\" -d"%solutionName%.DataAccess.TargetExt=.dll" -d"%solutionName%.DataAccess.TargetFileName=%solutionName%.DataAccess.dll" -d"%solutionName%.DataAccess.TargetName=%solutionName%.DataAccess" -d"%solutionName%.DataAccess.TargetPath=%src%\%solutionName%.DataAccess\bin\%buildConfiguration%\%wixBuildNet6Dir%\%solutionName%.DataAccess.dll" -d"%solutionName%.Model.Configuration=%buildConfiguration%" -d"%solutionName%.Model.FullConfiguration=%buildConfiguration%|%wixBuildPlatform%" -d"%solutionName%.Model.Platform=%wixBuildPlatform%" -d"%solutionName%.Model.ProjectDir=%src%\%solutionName%.Model\\" -d"%solutionName%.Model.ProjectExt=.csproj" -d"%solutionName%.Model.ProjectFileName=%solutionName%.Model.csproj" -d"%solutionName%.Model.ProjectName=%solutionName%.Model" -d"%solutionName%.Model.ProjectPath=%src%\%solutionName%.Model\%solutionName%.Model.csproj" -d"%solutionName%.Model.TargetDir=%src%\%solutionName%.Model\bin\%buildConfiguration%\%wixBuildNet6Dir%\\" -d"%solutionName%.Model.TargetExt=.dll" -d"%solutionName%.Model.TargetFileName=%solutionName%.Model.dll" -d"%solutionName%.Model.TargetName=%solutionName%.Model" -d"%solutionName%.Model.TargetPath=%src%\%solutionName%.Model\bin\%buildConfiguration%\%wixBuildNet6Dir%\%solutionName%.Model.dll" -d%solutionName%.Modbus.Configuration=%buildConfiguration% -d"%solutionName%.Modbus.FullConfiguration=%buildConfiguration%|%wixBuildPlatform%" -d%solutionName%.Modbus.Platform=%wixBuildPlatform% -d%solutionName%.Modbus.ProjectDir=%src%\%solutionName%\%solutionName%.Modbus\ -d%solutionName%.Modbus.ProjectExt=.csproj -d%solutionName%.Modbus.ProjectFileName=%solutionName%.Modbus.csproj -d%solutionName%.Modbus.ProjectName=%solutionName%.Modbus -d%solutionName%.Modbus.ProjectPath=%src%\%solutionName%\%solutionName%.Modbus\%solutionName%.Modbus.csproj -d%solutionName%.Modbus.TargetDir=%src%\%solutionName%.Modbus\bin\%buildConfiguration%\%wixBuildNet6Dir%\ -d%solutionName%.Modbus.TargetExt=.dll -d%solutionName%.Modbus.TargetFileName=%solutionName%.Modbus.dll -d%solutionName%.Modbus.TargetName=%solutionName%.Modbus -d%solutionName%.Modbus.TargetPath=%src%\%solutionName%.Modbus\bin\%buildConfiguration%\%wixBuildNet6Dir%\%solutionName%.Modbus.dll -d%solutionName%.Rainbow.Configuration=%buildConfiguration% -d"%solutionName%.Rainbow.FullConfiguration=%buildConfiguration%|%wixBuildPlatform%" -d%solutionName%.Rainbow.Platform=%wixBuildPlatform% -d%solutionName%.Rainbow.ProjectDir=%src%\%solutionName%\%solutionName%.Rainbow\ -d%solutionName%.Rainbow.ProjectExt=.csproj -d%solutionName%.Rainbow.ProjectFileName=%solutionName%.Rainbow.csproj -d%solutionName%.Rainbow.ProjectName=%solutionName%.Rainbow -d%solutionName%.Rainbow.ProjectPath=%src%\%solutionName%\%solutionName%.Rainbow\%solutionName%.Rainbow.csproj -d%solutionName%.Rainbow.TargetDir=%src%\%solutionName%.Rainbow\bin\%buildConfiguration%\%wixBuildNet6Dir%\ -d%solutionName%.Rainbow.TargetExt=.dll -d%solutionName%.Rainbow.TargetFileName=%solutionName%.Rainbow.dll -d%solutionName%.Rainbow.TargetName=%solutionName%.Rainbow -d%solutionName%.Rainbow.TargetPath=%src%\%solutionName%.Rainbow\bin\%buildConfiguration%\%wixBuildNet6Dir%\%solutionName%.Rainbow.dll -d%solutionName%.TestCase.Configuration=%buildConfiguration% -d"%solutionName%.TestCase.FullConfiguration=%buildConfiguration%|%wixBuildPlatform%" -d%solutionName%.TestCase.Platform=%wixBuildPlatform% -d%solutionName%.TestCase.ProjectDir=%src%\%solutionName%\%solutionName%.TestCase\ -d%solutionName%.TestCase.ProjectExt=.csproj -d%solutionName%.TestCase.ProjectFileName=%solutionName%.TestCase.csproj -d%solutionName%.TestCase.ProjectName=%solutionName%.TestCase -d%solutionName%.TestCase.ProjectPath=%src%\%solutionName%\%solutionName%.TestCase\%solutionName%.TestCase.csproj -d%solutionName%.TestCase.TargetDir=%src%\%solutionName%.TestCase\bin\%buildConfiguration%\%wixBuildNet6Dir%\ -d%solutionName%.TestCase.TargetExt=.dll -d%solutionName%.TestCase.TargetFileName=%solutionName%.TestCase.dll -d%solutionName%.TestCase.TargetName=%solutionName%.TestCase -d%solutionName%.TestCase.TargetPath=%src%\%solutionName%.TestCase\bin\%buildConfiguration%\%wixBuildNet6Dir%\%solutionName%.TestCase.dll -d%solutionName%.Server.Configuration=%buildConfiguration% -d"%solutionName%.Server.FullConfiguration=%buildConfiguration%|%wixBuildPlatform%" -d%solutionName%.Server.Platform=%wixBuildPlatform% -d%solutionName%.Server.ProjectDir=%src%\%solutionName%.Server\ -d%solutionName%.Server.ProjectExt=.csproj -d%solutionName%.Server.ProjectFileName=%solutionName%.Server.csproj -d%solutionName%.Server.ProjectName=%solutionName%.Server -d%solutionName%.Server.ProjectPath=%src%\%solutionName%.Server\%solutionName%.Server.csproj -d%solutionName%.Server.TargetDir=%src%\%solutionName%.Server\bin\%buildConfiguration%\%wixBuildNet6Dir%\ -d%solutionName%.Server.TargetExt=.dll -d"%solutionName%.Server.TargetFileName=%solutionName%.Server.dll" -d"%solutionName%.Server.TargetName=%solutionName%.Server" -d"%solutionName%.Server.TargetPath=%src%\%solutionName%.Server\bin\%buildConfiguration%\%wixBuildNet6Dir%\%solutionName%.Server.dll" -d"%solutionName%.UI.Configuration=%buildConfiguration%" -d"%solutionName%.UI.FullConfiguration=%buildConfiguration%|%wixBuildPlatform%" -d"%solutionName%.UI.Platform=%wixBuildPlatform%" -d"%solutionName%.UI.ProjectDir=%src%\%solutionName%.UI\\" -d"%solutionName%.UI.ProjectExt=.csproj" -d"%solutionName%.UI.ProjectFileName=%solutionName%.UI.csproj" -d"%solutionName%.UI.ProjectName=%solutionName%.UI" -d"%solutionName%.UI.ProjectPath=%src%\%solutionName%.UI\%solutionName%.UI.csproj" -d"%solutionName%.UI.TargetDir=%src%\%solutionName%.UI\bin\%buildConfiguration%\%wixBuildNet6Dir%\\" -d"%solutionName%.UI.TargetExt=.exe" -d"%solutionName%.UI.TargetFileName=%solutionName%.UI.exe" -d"%solutionName%.UI.TargetName=%solutionName%.UI" -d"%solutionName%.UI.TargetPath=%src%\%solutionName%.UI\bin\%buildConfiguration%\%wixBuildNet6Dir%\%solutionName%.UI.exe" -out obj\%buildConfiguration%\ -arch x86 -ext "%WIX%\bin\\WixUtilExtension.dll" -ext "%WIX%\bin\\WixUIExtension.dll" -ext "%WIX%\bin\\WixNetFxExtension.dll" Components.wxs Dependencies.wxs Directories.wxs Product.wxs Resources.wxs UserInterface.wxs		
"%WIX%\bin\light" -out "%src%\%wixBuildDirProjectName%\bin\%buildConfiguration%\%wixBuildDirProjectName%.msi" -pdbout "%src%\%wixBuildDirProjectName%\bin\%buildConfiguration%\%wixBuildDirProjectName%.wixpdb" -cultures:en-US -ext "%WIX%\bin\\WixUtilExtension.dll" -ext "%WIX%\bin\\WixUIExtension.dll" -ext "%WIX%\bin\\WixNetFxExtension.dll" -contentsfile obj\%buildConfiguration%\%wixBuildDirProjectName%.wixproj.BindContentsFileListen-US.txt -outputsfile obj\%buildConfiguration%\%wixBuildDirProjectName%.wixproj.BindOutputsFileListen-US.txt -builtoutputsfile obj\%buildConfiguration%\%wixBuildDirProjectName%.wixproj.BindBuiltOutputsFileListen-US.txt -wixprojectfile "%src%\%wixBuildDirProjectName%\%wixBuildDirProjectName%.wixproj" -cultures:en-us obj\%buildConfiguration%\Components.wixobj obj\%buildConfiguration%\Dependencies.wixobj obj\%buildConfiguration%\Directories.wixobj obj\%buildConfiguration%\Product.wixobj obj\%buildConfiguration%\Resources.wixobj obj\%buildConfiguration%\UserInterface.wixobj
